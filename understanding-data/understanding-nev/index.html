
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../understanding-anomalies/json-diff-timestamp/">
      
      
        <link rel="next" href="../understanding-ns5/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Understanding Nev - Video Sync</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nev-file-structure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Video Sync" class="md-header__button md-logo" aria-label="Video Sync" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Video Sync
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Understanding Nev
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/BCM-Neurosurgery/video-sync" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BCM-Neurosurgery/video-sync
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../configuration/" class="md-tabs__link">
        
  
    
  
  Configuration

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../features/" class="md-tabs__link">
        
  
    
  
  Features

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../emu-cameras/" class="md-tabs__link">
        
  
    
  
  EMU Camera Serials

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../license/" class="md-tabs__link">
        
  
    
  
  License

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developer-guide/" class="md-tabs__link">
          
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api/" class="md-tabs__link">
          
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../understanding-anomalies/discontinuity-in-json/" class="md-tabs__link">
          
  
  Understanding Anomalies

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Understanding Data

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Video Sync" class="md-nav__button md-logo" aria-label="Video Sync" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Video Sync
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/BCM-Neurosurgery/video-sync" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    BCM-Neurosurgery/video-sync
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../emu-cameras/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EMU Camera Serials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../license/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/program-flow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Program Flow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developer-guide/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/datapool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DataPool
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/nsx/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nsx
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/video/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Video
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/videojson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Videojson
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pathutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pathutils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Understanding Anomalies
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Understanding Anomalies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding-anomalies/discontinuity-in-json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discontinuity in JSON
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding-anomalies/discontinuity-in-nev/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Discontinuity in Nev
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../understanding-anomalies/json-diff-timestamp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON Timestamp Anomalies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" checked>
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Understanding Data
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Understanding Data
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Understanding Nev
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Understanding Nev
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nev-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      NEV File Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NEV File Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-header" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extended-headers" class="md-nav__link">
    <span class="md-ellipsis">
      Extended Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-packets" class="md-nav__link">
    <span class="md-ellipsis">
      Data Packets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-insertionreason" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding InsertionReason
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding InsertionReason">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relevant-values" class="md-nav__link">
    <span class="md-ellipsis">
      Relevant Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bitwise-breakdown-from-blackrock-nev-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Bitwise Breakdown (from BlackRock NEV Specification)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      Interpretation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-unparseddata" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding UnparsedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding UnparsedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-trigger-and-serial-are-sent-from-arduino" class="md-nav__link">
    <span class="md-ellipsis">
      How Trigger and Serial are sent from Arduino
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-trigger-and-serial-are-encoded-in-unparseddata" class="md-nav__link">
    <span class="md-ellipsis">
      How Trigger and Serial are encoded in UnparsedData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-serial-number-is-reconstructed-from-5-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      How Serial Number is reconstructed from 5 Bytes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How Serial Number is reconstructed from 5 Bytes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-the-camera-side" class="md-nav__link">
    <span class="md-ellipsis">
      From the Camera Side
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-the-nev-blackrock-side" class="md-nav__link">
    <span class="md-ellipsis">
      From the NEV (BlackRock) Side
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-between-trigger-and-serial" class="md-nav__link">
    <span class="md-ellipsis">
      Timing Between Trigger and Serial
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-ns5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding Ns5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../understanding-json/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Understanding JSON
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nev-file-structure" class="md-nav__link">
    <span class="md-ellipsis">
      NEV File Structure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NEV File Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-header" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extended-headers" class="md-nav__link">
    <span class="md-ellipsis">
      Extended Headers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-packets" class="md-nav__link">
    <span class="md-ellipsis">
      Data Packets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-insertionreason" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding InsertionReason
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding InsertionReason">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#relevant-values" class="md-nav__link">
    <span class="md-ellipsis">
      Relevant Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bitwise-breakdown-from-blackrock-nev-specification" class="md-nav__link">
    <span class="md-ellipsis">
      Bitwise Breakdown (from BlackRock NEV Specification)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interpretation" class="md-nav__link">
    <span class="md-ellipsis">
      Interpretation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    <span class="md-ellipsis">
      Usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#understanding-unparseddata" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding UnparsedData
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding UnparsedData">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-trigger-and-serial-are-sent-from-arduino" class="md-nav__link">
    <span class="md-ellipsis">
      How Trigger and Serial are sent from Arduino
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-trigger-and-serial-are-encoded-in-unparseddata" class="md-nav__link">
    <span class="md-ellipsis">
      How Trigger and Serial are encoded in UnparsedData
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-serial-number-is-reconstructed-from-5-bytes" class="md-nav__link">
    <span class="md-ellipsis">
      How Serial Number is reconstructed from 5 Bytes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How Serial Number is reconstructed from 5 Bytes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-the-camera-side" class="md-nav__link">
    <span class="md-ellipsis">
      From the Camera Side
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-the-nev-blackrock-side" class="md-nav__link">
    <span class="md-ellipsis">
      From the NEV (BlackRock) Side
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timing-between-trigger-and-serial" class="md-nav__link">
    <span class="md-ellipsis">
      Timing Between Trigger and Serial
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Understanding Nev</h1>

<h2 id="nev-file-structure">NEV File Structure<a class="headerlink" href="#nev-file-structure" title="Permanent link">&para;</a></h2>
<p>The <code>.nev</code> file format, developed by BlackRock Microsystems, is designed to store timestamped neural events such as spikes, TTL pulses, and serial messages. It supports up to 10,000 electrodes and includes both metadata and raw event data, structured to balance flexibility, efficiency, and ease of parsing.</p>
<p>A NEV file consists of three main components:</p>
<ul>
<li>Basic Header</li>
<li>Extended Headers</li>
<li>Data Packets</li>
</ul>
<h3 id="basic-header">Basic Header<a class="headerlink" href="#basic-header" title="Permanent link">&para;</a></h3>
<p>The basic header contains global metadata about the recording session, including the timestamp resolution and the origin of time. You can inspect it using <code>pyvideosync.nev.get_basic_header</code>. Key fields:</p>
<ul>
<li><strong>TimeStampResolution</strong>: Number of timestamp ticks per second (e.g., 30,000 means 1 tick = 33.3 μs).</li>
<li><strong>SampleTimeResolution</strong>: Used for waveform sampling resolution, often the same as TimeStampResolution.</li>
<li><strong>TimeOrigin</strong>: The UTC time when the recording started.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">nev</span><span class="o">.</span><span class="n">get_basic_header</span><span class="p">()</span>
<span class="p">{</span><span class="s1">&#39;FileTypeID&#39;</span><span class="p">:</span> <span class="s1">&#39;BREVENTS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FileSpec&#39;</span><span class="p">:</span> <span class="s1">&#39;3.0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AddFlags&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
 <span class="s1">&#39;BytesInHeader&#39;</span><span class="p">:</span> <span class="mi">26512</span><span class="p">,</span>
 <span class="s1">&#39;BytesInDataPackets&#39;</span><span class="p">:</span> <span class="mi">108</span><span class="p">,</span>
 <span class="s1">&#39;TimeStampResolution&#39;</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
 <span class="s1">&#39;SampleTimeResolution&#39;</span><span class="p">:</span> <span class="mi">30000</span><span class="p">,</span>
 <span class="s1">&#39;TimeOrigin&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">670000</span><span class="p">),</span>
 <span class="s1">&#39;CreatingApplication&#39;</span><span class="p">:</span> <span class="s1">&#39;File Dialog v7.6.1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Comment&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NumExtendedHeaders&#39;</span><span class="p">:</span> <span class="mi">818</span><span class="p">}</span>
</code></pre></div>
<p>MATLAB users can utilize the <a href="https://github.com/BlackrockNeurotech/NPMK/tree/master">NPMK package</a> from Blackrock Neurotech to read <code>.nev</code> files. The primary function for this is <code>openNEV</code>, which loads metadata, spike data, and digital events into a structured object.</p>
<p>To load a NEV file and access its metadata:</p>
<div class="highlight"><pre><span></span><code><span class="n">openNEV</span><span class="p">(</span><span class="s">&#39;filename.nev&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;read&#39;</span><span class="p">);</span>
</code></pre></div>
<p>This will return a <code>NEV</code> struct. The metadata fields are accessible via:</p>
<div class="highlight"><pre><span></span><code><span class="n">NEV</span><span class="p">.</span><span class="n">MetaTags</span>
</code></pre></div>
<p>This is functionally equivalent to calling <code>get_basic_header()</code> in the Python API.</p>
<p>Below is an example view of the <code>MetaTags</code> structure in MATLAB:</p>
<p><img alt="NEV Meta Tags" src="nevMetaTags.png" /></p>
<h3 id="extended-headers">Extended Headers<a class="headerlink" href="#extended-headers" title="Permanent link">&para;</a></h3>
<p>Extended headers in the NEV file contain channel-specific metadata, such as electrode labeling, waveform configuration, and filter settings. These entries provide essential information for interpreting neural data and are stored as a list of dictionaries in the Python API. Each entry is identified by a <code>PacketID</code>, which indicates the type of metadata.</p>
<p>Common <code>PacketID</code> types include:</p>
<ul>
<li><code>NEUEVWAV</code>: Waveform extraction settings</li>
<li><code>NEUEVLBL</code>: Electrode label</li>
<li><code>NEUEVFLT</code>: Filter parameters</li>
</ul>
<p>Example:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">nev</span><span class="o">.</span><span class="n">get_extended_headers</span><span class="p">()</span>
<span class="p">[{</span><span class="s1">&#39;PacketID&#39;</span><span class="p">:</span> <span class="s1">&#39;NEUEVWAV&#39;</span><span class="p">,</span>
  <span class="s1">&#39;ElectrodeID&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;PhysicalConnector&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;ConnectorPin&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;DigitizationFactor&#39;</span><span class="p">:</span> <span class="mi">250</span><span class="p">,</span>
  <span class="s1">&#39;EnergyThreshold&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s1">&#39;HighThreshold&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s1">&#39;LowThreshold&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">255</span><span class="p">,</span>
  <span class="s1">&#39;NumSortedUnits&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
  <span class="s1">&#39;BytesPerWaveform&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
  <span class="s1">&#39;SpikeWidthSamples&#39;</span><span class="p">:</span> <span class="mi">48</span><span class="p">,</span>
  <span class="s1">&#39;EmptyBytes&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00\x00\x00\x00\x00\x00\x00\x00</span><span class="s1">&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;PacketID&#39;</span><span class="p">:</span> <span class="s1">&#39;NEUEVLBL&#39;</span><span class="p">,</span>
  <span class="s1">&#39;ElectrodeID&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;Label&#39;</span><span class="p">:</span> <span class="s1">&#39;LdPF-mPF01-001&#39;</span><span class="p">,</span>
  <span class="s1">&#39;EmptyBytes&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00\x00\x00\x00\x00\x00</span><span class="s1">&#39;</span><span class="p">},</span>
 <span class="p">{</span><span class="s1">&#39;PacketID&#39;</span><span class="p">:</span> <span class="s1">&#39;NEUEVFLT&#39;</span><span class="p">,</span>
  <span class="s1">&#39;ElectrodeID&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;HighFreqCorner&#39;</span><span class="p">:</span> <span class="s1">&#39;250.0 Hz&#39;</span><span class="p">,</span>
  <span class="s1">&#39;HighFreqOrder&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
  <span class="s1">&#39;HighFreqType&#39;</span><span class="p">:</span> <span class="s1">&#39;butterworth&#39;</span><span class="p">,</span>
  <span class="s1">&#39;LowFreqCorner&#39;</span><span class="p">:</span> <span class="s1">&#39;7500.0 Hz&#39;</span><span class="p">,</span>
  <span class="s1">&#39;LowFreqOrder&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
  <span class="s1">&#39;LowFreqType&#39;</span><span class="p">:</span> <span class="s1">&#39;butterworth&#39;</span><span class="p">,</span>
  <span class="s1">&#39;EmptyBytes&#39;</span><span class="p">:</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00\x00</span><span class="s1">&#39;</span><span class="p">},</span>
  <span class="o">...</span>
<span class="p">]</span>
</code></pre></div>
<p>In MATLAB, this information is available through the <code>NEV.ElectrodesInfo</code> structure when using the <a href="https://github.com/BlackrockNeurotech/NPMK">NPMK</a> package:</p>
<div class="highlight"><pre><span></span><code><span class="n">NEV</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">openNEV</span><span class="p">(</span><span class="s">&#39;filename.nev&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;read&#39;</span><span class="p">);</span>
<span class="n">NEV</span><span class="p">.</span><span class="n">ElectrodesInfo</span>
</code></pre></div>
<p>This structure contains similar metadata, such as channel labels, thresholds, and filter settings.</p>
<p><img alt="NEV Electrodes Info" src="NEV-electrodes-info.png" /></p>
<h3 id="data-packets">Data Packets<a class="headerlink" href="#data-packets" title="Permanent link">&para;</a></h3>
<p>The <code>.nev</code> file also contains the actual timestamped events, such as TTL pulses or encoded serial data.</p>
<div class="highlight"><pre><span></span><code><span class="n">nev</span> <span class="o">=</span> <span class="n">Nev</span><span class="p">(</span><span class="n">nev_path</span><span class="p">)</span>
<span class="n">nev_digital_events_df</span> <span class="o">=</span> <span class="n">nev</span><span class="o">.</span><span class="n">get_digital_events_df</span><span class="p">()</span>
</code></pre></div>
<table>
<thead>
<tr>
<th style="text-align: right;">InsertionReason</th>
<th style="text-align: right;">TimeStamps</th>
<th style="text-align: right;">UnparsedData</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60414</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60415</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">114</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">104</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">42</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60414</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60415</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">115</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">104</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">42</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">1</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">0</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60414</td>
</tr>
<tr>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">60415</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">116</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">104</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">42</td>
</tr>
<tr>
<td style="text-align: right;">129</td>
<td style="text-align: right;">4.05746e+09</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
<p>Key columns:</p>
<ul>
<li><strong>TimeStamps</strong>: Integer-based timestamps with TimeStampResolution frequency (e.g., 30,000 Hz).</li>
<li><strong>InsertionReason</strong>: An 8-bit flag indicating why the event was inserted (e.g., digital change, serial input).</li>
<li><strong>UnparsedData</strong>: The raw 16-bit digital input or 7-bit serial payload (depending on the flag).</li>
</ul>
<p>In MATLAB, the same data can be accessed using the <a href="https://github.com/BlackrockNeurotech/NPMK">NPMK package</a>. After loading the NEV file with <code>openNEV</code>, digital events are available in:</p>
<div class="highlight"><pre><span></span><code><span class="n">NEV</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">openNEV</span><span class="p">(</span><span class="s">&#39;filename.nev&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;read&#39;</span><span class="p">);</span>
<span class="n">NEV</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">SerialDigitalIO</span>
</code></pre></div>
<p><img alt="Serial Digital IO" src="serial-digital-io.png" /></p>
<h2 id="understanding-insertionreason">Understanding <code>InsertionReason</code><a class="headerlink" href="#understanding-insertionreason" title="Permanent link">&para;</a></h2>
<p>The <code>InsertionReason</code> field in the NEV file is a <strong>bitwise flag</strong> that encodes the reason a particular event was recorded. Each bit represents a specific condition or source for the event. Multiple bits may be set simultaneously.</p>
<h3 id="relevant-values">Relevant Values<a class="headerlink" href="#relevant-values" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Value</th>
<th>Binary (8-bit)</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>1</code></td>
<td><code>00000001</code></td>
<td>A <strong>digital channel</strong> changed state (e.g., camera trigger line toggled)</td>
</tr>
<tr>
<td><code>129</code></td>
<td><code>10000001</code></td>
<td>A <strong>serial channel</strong> changed, and a digital change occurred (i.e., a serial byte was received)</td>
</tr>
</tbody>
</table>
<h3 id="bitwise-breakdown-from-blackrock-nev-specification">Bitwise Breakdown (from BlackRock NEV Specification)<a class="headerlink" href="#bitwise-breakdown-from-blackrock-nev-specification" title="Permanent link">&para;</a></h3>
<p>The <code>InsertionReason</code> byte is defined as follows:</p>
<table>
<thead>
<tr>
<th>Bit</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0</strong></td>
<td>Digital channel changed (e.g., rising/falling edge on a trigger line)</td>
</tr>
<tr>
<td><strong>1</strong></td>
<td>Event is from a strobed input</td>
</tr>
<tr>
<td><strong>2–6</strong></td>
<td>Reserved (unused)</td>
</tr>
<tr>
<td><strong>7</strong></td>
<td>Serial channel changed (must be set alongside Bit 0)</td>
</tr>
</tbody>
</table>
<h3 id="interpretation">Interpretation<a class="headerlink" href="#interpretation" title="Permanent link">&para;</a></h3>
<ul>
<li><code>0b00000001</code> (decimal <code>1</code>) → Digital event only  </li>
<li><code>0b10000001</code> (decimal <code>129</code>) → Serial event (with digital change)</li>
</ul>
<h3 id="usage">Usage<a class="headerlink" href="#usage" title="Permanent link">&para;</a></h3>
<ul>
<li>Use rows where <code>InsertionReason == 1</code> to extract <strong>digital trigger events</strong> (e.g., camera exposure).</li>
<li>Use rows where <code>InsertionReason == 129</code> to reconstruct <strong>serial counter values</strong> sent from Arduino in 5-byte chunks.</li>
</ul>
<p>This distinction is crucial for synchronizing camera frames with external signals such as triggers or Arduino-based serial counters.</p>
<h2 id="understanding-unparseddata">Understanding <code>UnparsedData</code><a class="headerlink" href="#understanding-unparseddata" title="Permanent link">&para;</a></h2>
<h3 id="how-trigger-and-serial-are-sent-from-arduino">How Trigger and Serial are sent from Arduino<a class="headerlink" href="#how-trigger-and-serial-are-sent-from-arduino" title="Permanent link">&para;</a></h3>
<p>The Arduino transmits both a trigger pulse and a serial-encoded counter value every frame:</p>
<p>The trigger pulse is sent via a digital output pin (e.g., pin 13) to the camera to initiate image capture.
Simultaneously, the counter value is incremented and transmitted over three serial ports — in the current setup, two going to the PCBs (used by the cameras) and one to the audio interface.</p>
<p>To ensure compatibility with the camera's serial input requirements, the counter value (a 32-bit unsigned integer) is split into 5 separate bytes, with each byte containing 7 bits of actual data. This is done because:</p>
<ul>
<li>The camera expects each byte to begin with a start bit</li>
<li>It can only receive one byte at a time, and only uses the lower 7 bits of each byte for data.</li>
<li>Therefore, transmitting the full 32-bit value requires 5 bytes (since 5 × 7 = 35 bits), with the upper 3 bits simply unused if not needed.</li>
</ul>
<p>The splitting and transmission are handled by this Arduino function:</p>
<div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">send_trigger_sync_to_pcb</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">trigger_pin</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span>

<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">bytesToSend</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span><span class="w"> </span><span class="c1">// Create an array to store the 5 bytes</span>
<span class="w">  </span><span class="c1">// Split the 32-bit integer into 5 bytes, each carrying 7 bits</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Shift right by 7 bits times the index and mask out the lower 7 bits</span>
<span class="w">    </span><span class="n">bytesToSend</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="p">(</span><span class="mi">7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x7F</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c1">//Send each byte over serial</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Serial1</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytesToSend</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="n">Serial2</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytesToSend</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="n">Serial3</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">bytesToSend</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="w">    </span><span class="n">Serial1</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
<span class="w">    </span><span class="n">Serial2</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
<span class="w">    </span><span class="n">Serial3</span><span class="p">.</span><span class="n">flush</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">trigger_pin</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span>
<span class="w">  </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="how-trigger-and-serial-are-encoded-in-unparseddata">How Trigger and Serial are encoded in <code>UnparsedData</code><a class="headerlink" href="#how-trigger-and-serial-are-encoded-in-unparseddata" title="Permanent link">&para;</a></h3>
<p>The UnparsedData field in the NEV digital events dataframe holds different meanings depending on the value of the InsertionReason flag.</p>
<p>For <code>InsertionReason == 1</code>, the <code>UnparsedData</code> value represents a 16-bit unsigned integer encoding the state of all 16 digital input lines. Each bit corresponds to a specific digital channel—commonly used for camera exposure signals or TTL triggers. Since the NEV file only records changes in digital line state (i.e., rising or falling edges), the data is <strong>sparse</strong> in time. To reconstruct the square waveforms of digital signals (such as camera exposure or external triggers), the following steps are required:</p>
<ul>
<li>Filter digital events where <code>InsertionReason == 1</code>.</li>
<li>Convert UnparsedData into a 16-bit binary representation.</li>
<li>Fill in gaps between timestamps to create a continuous time axis, since intermediate bit states are not recorded.</li>
<li>Extract the state of the specific bit corresponding to the channel of interest.</li>
<li>Plot the decoded signal as a square wave.</li>
</ul>
<p>This process is encapsulated in the <code>nev.plot_cam_exposure_all</code> function, which generates clear, continuous exposure traces:</p>
<p><img alt="Trigger Square Pulses" src="cam_expo.png" /></p>
<p>When <code>InsertionReason</code> is <code>129</code>, the UnparsedData value represents a 7-bit payload from serial communication. The Arduino transmits a 32-bit integer over serial by encoding it into five 7-bit bytes, each stored as a separate event with <code>InsertionReason == 129</code>.</p>
<p>To decode the full serial message:</p>
<ul>
<li>Group every 5 consecutive rows with <code>InsertionReason == 129</code>.</li>
<li>Extract the 7-bit data values from UnparsedData.</li>
<li>Reconstruct the original 32-bit integer by reversing the bit-shifting process.</li>
</ul>
<p>Each such 5-row group represents a complete serial counter value synchronized with a trigger pulse. This data can then be used for precise alignment between camera frames and neural events.</p>
<h3 id="how-serial-number-is-reconstructed-from-5-bytes">How Serial Number is reconstructed from 5 Bytes<a class="headerlink" href="#how-serial-number-is-reconstructed-from-5-bytes" title="Permanent link">&para;</a></h3>
<p>In this system, a 32-bit integer counter is transmitted from the Arduino in the form of 5 bytes, where each byte encodes 7 bits of actual data. Both the camera system and the BlackRock recording system receive this data and must reconstruct the original 32-bit counter value.</p>
<h4 id="from-the-camera-side">From the Camera Side<a class="headerlink" href="#from-the-camera-side" title="Permanent link">&para;</a></h4>
<p>In the <a href="https://github.com/BCM-Neurosurgery/MultiCameraTracking/blob/main/multi_camera/acquisition/flir_recording_api.py">camera recording software</a>, each byte is masked with 0x7F to retain only the lower 7 bits. The bytes are then shifted and combined to reconstruct the full 32-bit counter value.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">process_serial_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">serial_msg</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">frame_count</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpio_settings</span><span class="p">[</span><span class="s1">&#39;line3&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SerialOn&#39;</span><span class="p">:</span>
        <span class="c1"># We expect only 5 bytes to be sent</span>
        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">ChunkSerialDataLength</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">chunk_serial_data</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">ChunkSerialData</span>
            <span class="n">serial_msg</span> <span class="o">=</span> <span class="n">chunk_serial_data</span>
            <span class="n">split_chunk</span> <span class="o">=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chunk_serial_data</span><span class="p">]</span>

            <span class="n">frame_count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">split_chunk</span><span class="p">):</span>
                <span class="n">frame_count</span> <span class="o">|=</span> <span class="p">(</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span>
</code></pre></div>
<h4 id="from-the-nev-blackrock-side">From the NEV (BlackRock) Side<a class="headerlink" href="#from-the-nev-blackrock-side" title="Permanent link">&para;</a></h4>
<p>On the BlackRock system, serial data is captured within the <code>.nev</code> file and appears in rows where <code>InsertionReason == 129</code>. Each complete serial transmission occupies 5 consecutive rows in the event stream.</p>
<p>The NEV processing workflow involves:</p>
<ul>
<li>Filtering valid groups of 5 rows.</li>
<li>Extracting the UnparsedData field from each row.</li>
<li>Converting the 5 × 7-bit chunks back into a single integer.</li>
<li>Apply fix-anomaly scripts to fill in the gaps of the serial stream (Refer to edge cases documentation).</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_cleaned_digital_events_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    only keep the rows which satisfy</span>
<span class="sd">    1. InsertionReason == 129</span>
<span class="sd">    2. the length of such group is 5</span>
<span class="sd">    3. 0 &lt;= UnparsedData &lt;= 127 (should be true enforced by hardware)</span>

<span class="sd">    Returns</span>
<span class="sd">        InsertionReason     TimeStamps  UnparsedData</span>
<span class="sd">    2   129                 1345819     40</span>
<span class="sd">    3   129                 1345822     76</span>
<span class="sd">    4   129                 1345825     35</span>
<span class="sd">    5   129                 1345828     0</span>
<span class="sd">    6   129                 1345831     0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">digital_events_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_digital_events_df</span><span class="p">()</span>
    <span class="c1"># True indicates a change from 1 -&gt; 129 or 129 -&gt; 1</span>
    <span class="n">digital_events_df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">digital_events_df</span><span class="p">[</span><span class="s2">&quot;InsertionReason&quot;</span><span class="p">]</span>
        <span class="o">!=</span> <span class="n">digital_events_df</span><span class="p">[</span><span class="s2">&quot;InsertionReason&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="c1"># Count the size of each group and assign True where the group size</span>
    <span class="c1"># is 5 and the reason is 129</span>
    <span class="n">digital_events_df</span><span class="p">[</span><span class="s2">&quot;keeprows&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">digital_events_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)[</span>
        <span class="s2">&quot;InsertionReason&quot;</span>
    <span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">129</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">digital_events_df</span> <span class="o">=</span> <span class="n">digital_events_df</span><span class="p">[</span><span class="n">digital_events_df</span><span class="p">[</span><span class="s2">&quot;keeprows&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">]</span>
    <span class="n">digital_events_df</span> <span class="o">=</span> <span class="n">digital_events_df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="s2">&quot;keeprows&quot;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">digital_events_df</span>

<span class="k">def</span><span class="w"> </span><span class="nf">bits_to_decimal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nums</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    nums: [19, 101, 37, 0, 0]</span>

<span class="sd">    Returns:</span>
<span class="sd">    619155</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert each number to a 7-bit binary string with leading zeros</span>
    <span class="n">binary_strings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="s2">&quot;07b&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># Concatenate all binary strings into one long binary string</span>
    <span class="n">full_binary_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">binary_strings</span><span class="p">)</span>
    <span class="c1"># Convert the concatenated binary string to a decimal number</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">full_binary_string</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">get_chunk_serial_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timestamp_byte</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;first&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reconstruct chunk serial numbers from grouped digital events.</span>

<span class="sd">    Processes the cleaned digital events DataFrame by grouping every five consecutive rows,</span>
<span class="sd">    reconstructing each chunk serial number from the grouped 7-bit encoded values, and</span>
<span class="sd">    associating it with a corresponding timestamp. The timestamp used for each group</span>
<span class="sd">    can be explicitly selected as either the first or last byte in the group.</span>

<span class="sd">    Args:</span>
<span class="sd">        timestamp_byte (str, optional): Which byte&#39;s timestamp to use (&#39;first&#39; or &#39;last&#39;).</span>
<span class="sd">            Defaults to &#39;first&#39;. Use &#39;last&#39; if you want the timestamp representing</span>
<span class="sd">            the full completion of the serial transmission (recommended for accurate synchronization).</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing:</span>
<span class="sd">            - `TimeStamps`: Timestamp from the NEV data (based on selected byte).</span>
<span class="sd">            - `chunk_serial`: Reconstructed chunk serial number.</span>
<span class="sd">            - `UTCTimeStamp`: Human-readable UTC timestamp.</span>

<span class="sd">    Raises:</span>
<span class="sd">        AssertionError: If unparsed data is unavailable or timestamp_byte parameter is invalid.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; nev.get_chunk_serial_df(timestamp_byte=&#39;last&#39;)</span>
<span class="sd">                TimeStamps  chunk_serial              UTCTimeStamp</span>
<span class="sd">        0         1345819       583208  2024-04-16 21:48:17.195433</span>
<span class="sd">        1         1346821       583209  2024-04-16 21:48:17.228833</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_unparsed_data</span><span class="p">(),</span> <span class="s2">&quot;No unparsed data available.&quot;</span>
    <span class="k">assert</span> <span class="n">timestamp_byte</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="s2">&quot;first&quot;</span><span class="p">,</span>
        <span class="s2">&quot;last&quot;</span><span class="p">,</span>
    <span class="p">],</span> <span class="s2">&quot;timestamp_byte must be either &#39;first&#39; or &#39;last&#39;&quot;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cleaned_digital_events_df</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">nums</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;UnparsedData&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">decimal_number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bits_to_decimal</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>

            <span class="c1"># explicitly choose which byte&#39;s timestamp to use</span>
            <span class="k">if</span> <span class="n">timestamp_byte</span> <span class="o">==</span> <span class="s2">&quot;first&quot;</span><span class="p">:</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;TimeStamps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># timestamp_byte == &#39;last&#39;</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">group</span><span class="p">[</span><span class="s2">&quot;TimeStamps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">unix_time</span> <span class="o">=</span> <span class="n">ts2unix</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">timeOrigin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestampResolution</span><span class="p">,</span> <span class="n">timestamp</span>
            <span class="p">)</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">decimal_number</span><span class="p">,</span> <span class="n">unix_time</span><span class="p">))</span>

    <span class="c1"># Explicitly fill missing serials if necessary</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">fill_missing_serials_with_gap</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span>
        <span class="n">results</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;TimeStamps&quot;</span><span class="p">,</span> <span class="s2">&quot;chunk_serial&quot;</span><span class="p">,</span> <span class="s2">&quot;UTCTimeStamp&quot;</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div>
<h3 id="timing-between-trigger-and-serial">Timing Between Trigger and Serial<a class="headerlink" href="#timing-between-trigger-and-serial" title="Permanent link">&para;</a></h3>
<p>According to the Arduino code, the trigger pulse is initiated immediately before the serial data transmission begins:</p>
<div class="highlight"><pre><span></span><code><span class="kt">bool</span><span class="w"> </span><span class="nf">send_trigger_sync_to_pcb</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">trigger_pin</span><span class="p">,</span><span class="w"> </span><span class="n">HIGH</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// code to sent serial...</span>

<span class="w">  </span><span class="n">digitalWrite</span><span class="p">(</span><span class="n">trigger_pin</span><span class="p">,</span><span class="w"> </span><span class="n">LOW</span><span class="p">);</span>
<span class="w">  </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>When observing the NEV recording, we find that the trigger pulse is captured exactly one timestamp before the first byte of the 5-byte serial transmission. This confirms the ordering and tight timing between the two signals. This relationship is visualized in the following figure:</p>
<p><img alt="Timing Between Trigger and Serial" src="cam_expo2.png" /></p>
<p>This precise sequencing is essential for synchronizing camera frames with neural recordings. The reliable 1-timestamp offset can be leveraged during analysis to align data streams accurately.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/BCM-Neurosurgery/video-sync" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.tabs", "navigation.top", "search.highlight", "search.suggest", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>